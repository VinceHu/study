---
title: HTTP 1.1, 2.0, 3.0 çš„ä¸»è¦åŒºåˆ«
date: 2025-11-27
category: ç½‘ç»œ
difficulty: ä¸­çº§
tags: [HTTP, HTTP/2, HTTP/3, QUIC, æ€§èƒ½ä¼˜åŒ–]
related: [tcp-handshake.md, cors.md]
hasCode: true
---

# HTTP 1.1, 2.0, 3.0 çš„ä¸»è¦åŒºåˆ«

## ğŸ“ æ ‡å‡†ç­”æ¡ˆ

### æ ¸å¿ƒè¦ç‚¹

1. **HTTP/1.1ï¼ˆ1997å¹´ï¼‰**ï¼š
   - æŒä¹…è¿æ¥ï¼ˆKeep-Aliveï¼‰
   - ç®¡é“åŒ–ï¼ˆPipeliningï¼‰
   - ç¼“å­˜æ§åˆ¶
   - é—®é¢˜ï¼šé˜Ÿå¤´é˜»å¡ã€è¿æ¥æ•°é™åˆ¶

2. **HTTP/2ï¼ˆ2015å¹´ï¼‰**ï¼š
   - äºŒè¿›åˆ¶åˆ†å¸§
   - å¤šè·¯å¤ç”¨
   - å¤´éƒ¨å‹ç¼©ï¼ˆHPACKï¼‰
   - æœåŠ¡å™¨æ¨é€
   - åŸºäº TCP

3. **HTTP/3ï¼ˆ2022å¹´ï¼‰**ï¼š
   - åŸºäº QUICï¼ˆUDPï¼‰
   - è§£å†³é˜Ÿå¤´é˜»å¡
   - 0-RTT è¿æ¥å»ºç«‹
   - è¿æ¥è¿ç§»
   - æ›´å¥½çš„æ‹¥å¡æ§åˆ¶

### è¯¦ç»†è¯´æ˜

#### HTTP/1.1 çš„ç‰¹ç‚¹

**1. æŒä¹…è¿æ¥ï¼ˆKeep-Aliveï¼‰**

```http
// HTTP/1.0ï¼šæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»ºç«‹æ–°è¿æ¥
è¯·æ±‚1 â†’ å»ºç«‹è¿æ¥ â†’ å“åº”1 â†’ å…³é—­è¿æ¥
è¯·æ±‚2 â†’ å»ºç«‹è¿æ¥ â†’ å“åº”2 â†’ å…³é—­è¿æ¥

// HTTP/1.1ï¼šå¤ç”¨è¿æ¥
å»ºç«‹è¿æ¥ â†’ è¯·æ±‚1 â†’ å“åº”1 â†’ è¯·æ±‚2 â†’ å“åº”2 â†’ ... â†’ å…³é—­è¿æ¥

Connection: keep-alive
Keep-Alive: timeout=5, max=100
```

**2. ç®¡é“åŒ–ï¼ˆPipeliningï¼‰**

```http
// ä¸ç­‰å¾…å“åº”ï¼Œè¿ç»­å‘é€å¤šä¸ªè¯·æ±‚
è¯·æ±‚1 â†’ è¯·æ±‚2 â†’ è¯·æ±‚3 â†’ å“åº”1 â†’ å“åº”2 â†’ å“åº”3

// é—®é¢˜ï¼šå“åº”å¿…é¡»æŒ‰é¡ºåºè¿”å›ï¼ˆé˜Ÿå¤´é˜»å¡ï¼‰
```

**3. HTTP/1.1 çš„é—®é¢˜**

```
1. é˜Ÿå¤´é˜»å¡ï¼ˆHead-of-Line Blockingï¼‰
   - å‰é¢çš„è¯·æ±‚é˜»å¡åé¢çš„è¯·æ±‚
   - å³ä½¿åé¢çš„è¯·æ±‚å·²ç»å¤„ç†å®Œæˆ

2. è¿æ¥æ•°é™åˆ¶
   - æµè§ˆå™¨é™åˆ¶åŒåŸŸåå¹¶å‘è¿æ¥æ•°ï¼ˆé€šå¸¸ 6 ä¸ªï¼‰
   - éœ€è¦åŸŸååˆ†ç‰‡ï¼ˆDomain Shardingï¼‰

3. å¤´éƒ¨å†—ä½™
   - æ¯ä¸ªè¯·æ±‚éƒ½æºå¸¦å®Œæ•´çš„å¤´éƒ¨
   - å¤§é‡é‡å¤ä¿¡æ¯

4. æ˜æ–‡ä¼ è¾“
   - ä¸å®‰å…¨ï¼Œéœ€è¦ HTTPS
```

## ğŸ§  æ·±åº¦ç†è§£

#### HTTP/2 çš„æ”¹è¿›

**1. äºŒè¿›åˆ¶åˆ†å¸§ï¼ˆBinary Framingï¼‰**

```
HTTP/1.1ï¼šæ–‡æœ¬åè®®
GET /index.html HTTP/1.1
Host: example.com

HTTP/2ï¼šäºŒè¿›åˆ¶åè®®
+-----------------------------------------------+
| Length (24) | Type (8) | Flags (8) | Stream ID (31) |
+-----------------------------------------------+
|                   Frame Payload                |
+-----------------------------------------------+
```

**2. å¤šè·¯å¤ç”¨ï¼ˆMultiplexingï¼‰**

```
HTTP/1.1ï¼š
è¿æ¥1 â†’ è¯·æ±‚1 â†’ å“åº”1
è¿æ¥2 â†’ è¯·æ±‚2 â†’ å“åº”2
è¿æ¥3 â†’ è¯·æ±‚3 â†’ å“åº”3

HTTP/2ï¼š
å•ä¸ªè¿æ¥ â†’ è¯·æ±‚1ã€è¯·æ±‚2ã€è¯·æ±‚3 â†’ å“åº”1ã€å“åº”2ã€å“åº”3
ï¼ˆå¹¶è¡Œï¼Œä¸æŒ‰é¡ºåºï¼‰

ä¼˜åŠ¿ï¼š
- è§£å†³é˜Ÿå¤´é˜»å¡ï¼ˆåº”ç”¨å±‚ï¼‰
- å‡å°‘è¿æ¥æ•°
- æ›´å¥½çš„èµ„æºåˆ©ç”¨
```

**3. å¤´éƒ¨å‹ç¼©ï¼ˆHPACKï¼‰**

```javascript
// HTTP/1.1ï¼šæ¯æ¬¡éƒ½å‘é€å®Œæ•´å¤´éƒ¨
GET /api/user HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0...
Accept: application/json
Cookie: session=abc123...

GET /api/posts HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0...  // é‡å¤
Accept: application/json    // é‡å¤
Cookie: session=abc123...   // é‡å¤

// HTTP/2ï¼šä½¿ç”¨ç´¢å¼•è¡¨å‹ç¼©
è¯·æ±‚1ï¼šå®Œæ•´å¤´éƒ¨
è¯·æ±‚2ï¼š[2] [3] [4]  // å¼•ç”¨ç´¢å¼•ï¼Œå¤§å¹…å‡å°‘æ•°æ®é‡
```

**4. æœåŠ¡å™¨æ¨é€ï¼ˆServer Pushï¼‰**

```javascript
// å®¢æˆ·ç«¯è¯·æ±‚ HTML
GET /index.html

// æœåŠ¡å™¨ä¸»åŠ¨æ¨é€ CSS å’Œ JS
PUSH_PROMISE /style.css
PUSH_PROMISE /script.js

// å®¢æˆ·ç«¯æ”¶åˆ° HTML å’Œæ¨é€çš„èµ„æº
// æ— éœ€é¢å¤–è¯·æ±‚
```

**5. HTTP/2 çš„é—®é¢˜**

```
TCP å±‚çš„é˜Ÿå¤´é˜»å¡ï¼š
- HTTP/2 è§£å†³äº†åº”ç”¨å±‚çš„é˜Ÿå¤´é˜»å¡
- ä½† TCP å±‚ä»ç„¶å­˜åœ¨é˜Ÿå¤´é˜»å¡
- ä¸€ä¸ª TCP åŒ…ä¸¢å¤±ï¼Œä¼šé˜»å¡æ•´ä¸ªè¿æ¥

ç¤ºä¾‹ï¼š
Stream 1: [åŒ…1] [åŒ…2] [åŒ…3]
Stream 2: [åŒ…4] [åŒ…5] [åŒ…6]

å¦‚æœåŒ…2ä¸¢å¤±ï¼š
- åŒ…3ã€åŒ…4ã€åŒ…5ã€åŒ…6 éƒ½è¦ç­‰å¾…åŒ…2é‡ä¼ 
- å³ä½¿å®ƒä»¬å·²ç»åˆ°è¾¾
```

#### HTTP/3 çš„é©æ–°

**1. åŸºäº QUICï¼ˆQuick UDP Internet Connectionsï¼‰**

```
HTTP/1.1 å’Œ HTTP/2ï¼š
åº”ç”¨å±‚ (HTTP) â†’ ä¼ è¾“å±‚ (TCP) â†’ ç½‘ç»œå±‚ (IP)

HTTP/3ï¼š
åº”ç”¨å±‚ (HTTP/3) â†’ ä¼ è¾“å±‚ (QUIC/UDP) â†’ ç½‘ç»œå±‚ (IP)

QUIC ç‰¹ç‚¹ï¼š
- åŸºäº UDP
- å†…ç½® TLS 1.3
- è¿æ¥è¿ç§»
- æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶
```

**2. è§£å†³é˜Ÿå¤´é˜»å¡**

```
HTTP/2 (TCP)ï¼š
Stream 1: [åŒ…1] [åŒ…2ä¸¢å¤±] [åŒ…3]
Stream 2: [åŒ…4] [åŒ…5] [åŒ…6]
â†’ åŒ…2ä¸¢å¤±ï¼Œæ‰€æœ‰æµéƒ½é˜»å¡

HTTP/3 (QUIC)ï¼š
Stream 1: [åŒ…1] [åŒ…2ä¸¢å¤±] [åŒ…3]
Stream 2: [åŒ…4] [åŒ…5] [åŒ…6]
â†’ åŒ…2ä¸¢å¤±ï¼Œåªé˜»å¡ Stream 1ï¼ŒStream 2 ç»§ç»­
```

**3. 0-RTT è¿æ¥å»ºç«‹**

```
HTTP/1.1 + TLS 1.2ï¼š
TCP ä¸‰æ¬¡æ¡æ‰‹ (1 RTT) + TLS æ¡æ‰‹ (2 RTT) = 3 RTT

HTTP/2 + TLS 1.3ï¼š
TCP ä¸‰æ¬¡æ¡æ‰‹ (1 RTT) + TLS æ¡æ‰‹ (1 RTT) = 2 RTT

HTTP/3 + QUICï¼š
QUIC æ¡æ‰‹ (1 RTT)
æˆ– 0-RTTï¼ˆä½¿ç”¨ä¹‹å‰çš„ä¼šè¯å¯†é’¥ï¼‰
```

**4. è¿æ¥è¿ç§»**

```
åœºæ™¯ï¼šæ‰‹æœºä» WiFi åˆ‡æ¢åˆ° 4G

HTTP/1.1 å’Œ HTTP/2ï¼š
- IP åœ°å€æ”¹å˜
- TCP è¿æ¥æ–­å¼€
- éœ€è¦é‡æ–°å»ºç«‹è¿æ¥

HTTP/3ï¼š
- ä½¿ç”¨è¿æ¥ ID æ ‡è¯†è¿æ¥
- IP åœ°å€æ”¹å˜ä¸å½±å“è¿æ¥
- æ— ç¼åˆ‡æ¢ç½‘ç»œ
```

### ç‰ˆæœ¬å¯¹æ¯”è¡¨

| ç‰¹æ€§ | HTTP/1.1 | HTTP/2 | HTTP/3 |
|------|----------|--------|--------|
| å‘å¸ƒå¹´ä»½ | 1997 | 2015 | 2022 |
| ä¼ è¾“åè®® | TCP | TCP | QUIC (UDP) |
| æ•°æ®æ ¼å¼ | æ–‡æœ¬ | äºŒè¿›åˆ¶ | äºŒè¿›åˆ¶ |
| å¤šè·¯å¤ç”¨ | âŒ | âœ… | âœ… |
| å¤´éƒ¨å‹ç¼© | âŒ | âœ… (HPACK) | âœ… (QPACK) |
| æœåŠ¡å™¨æ¨é€ | âŒ | âœ… | âœ… |
| é˜Ÿå¤´é˜»å¡ | âœ… åº”ç”¨å±‚ | âœ… TCPå±‚ | âŒ |
| è¿æ¥å»ºç«‹ | 3 RTT | 2 RTT | 0-1 RTT |
| è¿æ¥è¿ç§» | âŒ | âŒ | âœ… |

### æ€§èƒ½å¯¹æ¯”

```
é¡µé¢åŠ è½½æ—¶é—´ï¼ˆ100ä¸ªèµ„æºï¼‰ï¼š

HTTP/1.1ï¼š
- 6ä¸ªå¹¶å‘è¿æ¥
- æ¯ä¸ªè¿æ¥ä¸²è¡ŒåŠ è½½
- æ€»æ—¶é—´ï¼šçº¦ 10 ç§’

HTTP/2ï¼š
- å•ä¸ªè¿æ¥
- å¤šè·¯å¤ç”¨
- æ€»æ—¶é—´ï¼šçº¦ 3 ç§’

HTTP/3ï¼š
- å•ä¸ªè¿æ¥
- å¤šè·¯å¤ç”¨ + æ— é˜Ÿå¤´é˜»å¡
- æ€»æ—¶é—´ï¼šçº¦ 2 ç§’
```

### å¸¸è§è¯¯åŒº

1. **è¯¯åŒºï¼šHTTP/2 ä¸€å®šæ¯” HTTP/1.1 å¿«**
   ```
   âŒ ä¸ä¸€å®š
   - åœ¨ä¸¢åŒ…ç‡é«˜çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼ŒHTTP/2 å¯èƒ½æ›´æ…¢
   - TCP é˜Ÿå¤´é˜»å¡ä¼šå½±å“æ‰€æœ‰æµ
   - HTTP/1.1 çš„å¤šä¸ªè¿æ¥å¯ä»¥å¹¶è¡Œé‡ä¼ 
   ```

2. **è¯¯åŒºï¼šHTTP/3 å®Œå…¨æ›¿ä»£ HTTP/2**
   ```
   âŒ ä¸æ˜¯
   - HTTP/3 éœ€è¦ UDP æ”¯æŒ
   - éƒ¨åˆ†ç½‘ç»œç¯å¢ƒé˜»æ­¢ UDP
   - éœ€è¦é™çº§åˆ° HTTP/2 æˆ– HTTP/1.1
   ```

3. **è¯¯åŒºï¼šHTTP/2 ä¸éœ€è¦åŸŸååˆ†ç‰‡**
   ```
   âœ… æ­£ç¡®
   - HTTP/2 å¤šè·¯å¤ç”¨ï¼Œå•ä¸ªè¿æ¥å³å¯
   - åŸŸååˆ†ç‰‡åè€Œä¼šé™ä½æ€§èƒ½
   - å¢åŠ  DNS æŸ¥è¯¢å’Œ TCP è¿æ¥å¼€é”€
   ```

## ğŸ’¡ é¢è¯•å›ç­”æŠ€å·§

### æ¨èå›ç­”é¡ºåº

1. **å…ˆè¯´ HTTP/1.1**ï¼š
   - "æŒä¹…è¿æ¥ã€ç®¡é“åŒ–"
   - "é—®é¢˜ï¼šé˜Ÿå¤´é˜»å¡ã€è¿æ¥æ•°é™åˆ¶"

2. **å†è¯´ HTTP/2**ï¼š
   - "äºŒè¿›åˆ¶åˆ†å¸§ã€å¤šè·¯å¤ç”¨"
   - "å¤´éƒ¨å‹ç¼©ã€æœåŠ¡å™¨æ¨é€"
   - "è§£å†³åº”ç”¨å±‚é˜Ÿå¤´é˜»å¡"

3. **ç„¶åè¯´ HTTP/3**ï¼š
   - "åŸºäº QUICï¼ˆUDPï¼‰"
   - "è§£å†³ TCP å±‚é˜Ÿå¤´é˜»å¡"
   - "0-RTTã€è¿æ¥è¿ç§»"

4. **æœ€åè¯´åº”ç”¨**ï¼š
   - "HTTP/2 å·²å¹¿æ³›åº”ç”¨"
   - "HTTP/3 é€æ­¥æ™®åŠ"
   - "éœ€è¦è€ƒè™‘å…¼å®¹æ€§"

### é‡ç‚¹å¼ºè°ƒ

- âœ… **å¤šè·¯å¤ç”¨çš„ä¼˜åŠ¿**
- âœ… **é˜Ÿå¤´é˜»å¡çš„å±‚æ¬¡**
- âœ… **QUIC çš„åˆ›æ–°**
- âœ… **æ€§èƒ½æå‡çš„åŸå› **

### å¯èƒ½çš„è¿½é—®

**Q1: å¦‚ä½•å‡çº§åˆ° HTTP/2ï¼Ÿ**

A:
1. æœåŠ¡å™¨æ”¯æŒ HTTP/2
2. å¯ç”¨ HTTPSï¼ˆHTTP/2 è¦æ±‚ï¼‰
3. é…ç½® ALPNï¼ˆApplication-Layer Protocol Negotiationï¼‰
4. æµè§ˆå™¨è‡ªåŠ¨åå•†ä½¿ç”¨ HTTP/2

**Q2: HTTP/2 çš„æœåŠ¡å™¨æ¨é€æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

A:
- å¯èƒ½æ¨é€ä¸éœ€è¦çš„èµ„æº
- æµªè´¹å¸¦å®½
- ç¼“å­˜ç®¡ç†å¤æ‚
- HTTP/3 æ”¹è¿›äº†æ¨é€æœºåˆ¶

**Q3: ä¸ºä»€ä¹ˆ HTTP/3 ä½¿ç”¨ UDPï¼Ÿ**

A:
- TCP åè®®å›ºåŒ–åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸
- éš¾ä»¥ä¿®æ”¹å’Œå‡çº§
- UDP æ›´çµæ´»ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ç©ºé—´å®ç°
- QUIC åœ¨ UDP ä¹‹ä¸Šå®ç°äº†å¯é ä¼ è¾“

**Q4: å¦‚ä½•æ£€æµ‹ç½‘ç«™ä½¿ç”¨çš„ HTTP ç‰ˆæœ¬ï¼Ÿ**

A:
```javascript
// Chrome DevTools
// Network â†’ Protocol åˆ—

// æˆ–ä½¿ç”¨ JavaScript
fetch('https://example.com')
  .then(res => {
    console.log(res.headers.get('alt-svc'));
    // h3=":443" è¡¨ç¤ºæ”¯æŒ HTTP/3
  });
```

## ğŸ’» ä»£ç ç¤ºä¾‹

### HTTP/2 æœåŠ¡å™¨é…ç½®

```javascript
// Node.js HTTP/2 æœåŠ¡å™¨
const http2 = require('http2');
const fs = require('fs');

const server = http2.createSecureServer({
  key: fs.readFileSync('server.key'),
  cert: fs.readFileSync('server.crt')
});

server.on('stream', (stream, headers) => {
  // æœåŠ¡å™¨æ¨é€
  stream.pushStream({ ':path': '/style.css' }, (err, pushStream) => {
    if (err) throw err;
    pushStream.respond({ ':status': 200 });
    pushStream.end(fs.readFileSync('style.css'));
  });
  
  // å“åº”ä¸»è¯·æ±‚
  stream.respond({
    'content-type': 'text/html',
    ':status': 200
  });
  stream.end('<html><body>Hello HTTP/2</body></html>');
});

server.listen(443);
```

### æ£€æµ‹ HTTP ç‰ˆæœ¬

```javascript
// æ£€æµ‹æµè§ˆå™¨æ”¯æŒçš„ HTTP ç‰ˆæœ¬
async function detectHTTPVersion(url) {
  try {
    const response = await fetch(url);
    const protocol = response.headers.get('alt-svc');
    
    if (protocol && protocol.includes('h3')) {
      return 'HTTP/3';
    } else if (window.chrome && chrome.loadTimes) {
      const timing = chrome.loadTimes();
      if (timing.npnNegotiatedProtocol === 'h2') {
        return 'HTTP/2';
      }
    }
    
    return 'HTTP/1.1';
  } catch (error) {
    console.error('Error:', error);
    return 'Unknown';
  }
}

// ä½¿ç”¨
detectHTTPVersion('https://example.com')
  .then(version => console.log('HTTP Version:', version));
```

## ğŸ”— ç›¸å…³çŸ¥è¯†ç‚¹

- [TCP ä¸‰æ¬¡æ¡æ‰‹](./tcp-handshake.md)
- [ä»è¾“å…¥ URL åˆ°é¡µé¢å±•ç¤º](../browser/url-to-page.md)
- [æµè§ˆå™¨ç¼“å­˜](../performance/cache-strategy.md)

## ğŸ“š å‚è€ƒèµ„æ–™

- [HTTP/2 RFC 7540](https://httpwg.org/specs/rfc7540.html)
- [HTTP/3 RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)
- [QUIC RFC 9000](https://www.rfc-editor.org/rfc/rfc9000.html)
